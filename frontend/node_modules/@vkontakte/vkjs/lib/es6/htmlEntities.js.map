{"version":3,"file":"htmlEntities.js","names":["fromCodePoint","getCodePointAt","numericUnicodeMap","escapeMap","unescapeMap","namedEntities","ESCAPE_REGEX","escape","input","replace","entity","UNESCAPE_REGEX","unescape","outOfBoundsChar","String","fromCharCode","ENCODE_REGEX","encodeHTMLEntities","code","length","charCodeAt","DECODE_REGEX","decodeHTMLEntities","reduce","result","mask","char","RegExp","secondChar","parseInt","substr","decodeHTMLEntitiesDeep","correctType","Object","prototype","toString","apply","map","item","response","keys","forEach"],"sources":["../../src/htmlEntities.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/quotes */\nimport { fromCodePoint, getCodePointAt, numericUnicodeMap } from './lib/codepoints';\nimport { Dictionary } from './types';\n\nconst escapeMap: Record<string, string> = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  \"'\": '&#39;',\n  '\"': '&quot;',\n};\n\nconst unescapeMap: Record<string, string> = {\n  '&amp;': '&',\n  '&#38;': '&',\n  '&lt;': '<',\n  '&#60;': '<',\n  '&gt;': '>',\n  '&#62;': '>',\n  '&apos;': \"'\",\n  '&#39;': \"'\",\n  '&quot;': '\"',\n  '&#34;': '\"',\n};\n\nconst namedEntities = [\n  ['&amp;', '&'],\n  ['&lt;', '<'],\n  ['&gt;', '>'],\n  ['&quot;', '\"'],\n  ['&apos;', `'`],\n];\n\nconst ESCAPE_REGEX = /[&<>'\"]/g;\n\n/**\n * Safely escape HTML entities such as `&`, `<`, `>`, `\"`, and `'`\n * @param {string} input\n */\nexport function escape(input: string): string {\n  if (input == null) {\n    return '';\n  }\n\n  return input.replace(ESCAPE_REGEX, (entity) => {\n    return escapeMap[entity];\n  });\n}\n\nconst UNESCAPE_REGEX = /&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34);/g;\n\n/**\n * Unescape HTML entities such as `&`, `<`, `>`, `\"`, and `'`\n * @param {string} input\n */\nexport function unescape(input: string): string {\n  if (input == null) {\n    return '';\n  }\n\n  return input.replace(UNESCAPE_REGEX, (entity) => {\n    return unescapeMap[entity];\n  });\n}\n\nexport const outOfBoundsChar = String.fromCharCode(65533);\n\nconst ENCODE_REGEX =\n  /(?:[<>'\"&\\x01-\\x08\\x11-\\x15\\x17-\\x1F\\x7f-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])/g;\n\nexport function encodeHTMLEntities(input: string): string {\n  if (input == null) {\n    return '';\n  }\n\n  return input.replace(ENCODE_REGEX, (entity) => {\n    const code = entity.length > 1 ? getCodePointAt(entity, 0) : entity.charCodeAt(0);\n    return '&#' + String(code) + ';';\n  });\n}\n\nconst DECODE_REGEX = /&(?:#\\d+|#[xX][\\da-fA-F]+|[0-9a-zA-Z]+);/g;\n\nexport function decodeHTMLEntities(input: string): string {\n  if (input == null) {\n    return '';\n  }\n\n  input = namedEntities.reduce(\n    (result, [mask, char]) => result.replace(new RegExp(mask, 'ig'), char),\n    input,\n  );\n\n  return input.replace(DECODE_REGEX, (entity) => {\n    if (entity[0] === '&' && entity[1] === '#') {\n      const secondChar = entity[2];\n      const code =\n        secondChar === 'x' || secondChar === 'X'\n          ? parseInt(entity.substr(3), 16)\n          : parseInt(entity.substr(2));\n\n      if (code >= 0x10ffff) {\n        return outOfBoundsChar;\n      }\n\n      if (code > 65535) {\n        return fromCodePoint(code);\n      }\n\n      return String.fromCharCode(numericUnicodeMap[code] || code);\n    }\n\n    return entity;\n  });\n}\n\nexport function decodeHTMLEntitiesDeep<T>(input: T): T {\n  if (typeof input === 'string') {\n    return decodeHTMLEntities(input) as unknown as T;\n  }\n\n  if (typeof input === 'object') {\n    const correctType = Object.prototype.toString.apply(input);\n\n    if (correctType === '[object Array]') {\n      return (input as unknown[]).map((item) => {\n        return decodeHTMLEntitiesDeep(item);\n      }) as T;\n    }\n\n    if (correctType === '[object Object]') {\n      const response: Dictionary<unknown> = {};\n      Object.keys(input as Dictionary<unknown>).forEach((item) => {\n        response[decodeHTMLEntities(item)] = decodeHTMLEntitiesDeep(\n          (input as Dictionary<unknown>)[item],\n        );\n      });\n\n      return response as unknown as T;\n    }\n  }\n\n  return input;\n}\n"],"mappings":"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"}